TOP = ..\..\..\..

BUILD_FOR_CORESYSTEM=1

TARGETNAME=test_mimofcodec
TARGETTYPE=DYNLINK
DLLDEF=
UNICODE=1
UT_TARGET_DEST=WinOMI\tests
TARGET_DESTINATION=$(UT_TARGET_DEST)\bin

USE_MSVCRT=1
USE_STL=1
USE_NATIVE_EH=1

C_DEFINES=$(C_DEFINES)  \
    /DMI_INTERNAL \
    /DWINBUILD \
    /D_UNICODE \
    /DUNICODE \
    /DCONFIG_ENABLE_WCHAR \
    /DMI_CONST= \
    /DTEST_BUILD \

SOURCES = \
    consts.c \
    test_lex.cpp \
    test_parser.cpp \
    test_mof.cpp \
    dllmain.c \
    test_mofserializer.cpp \
    instance.c \
    schema.c \
    class.c \
    qualifierset.c \
    parameterset.c \
    DefaultResource.rc # Autogenerated file name + version for Device Guard whitelisting effort

INCLUDES=$(INCLUDES); \
    $(TOP); \
    $(TOP)\codec\common; \
    $(TOP)\codec\mof\parser; \
    $(TOP)\common; \
    $(TOP)\common\windows; \
    $(TOP)\nits\base; \

TARGETLIBS= \
    $(MINCORE_SDK_LIB_VPATH)\mincore.lib \
    $(SDK_LIB_PATH)\mi.lib \
    $(OBJECT_ROOT)\admin\wmi\winomi\codec\mof\blue\$O\mimofcodec.lib \
    $(OBJECT_ROOT)\admin\wmi\winomi\tests\codec\mof\util\$O\moftestutil.lib \
    $(OBJECT_ROOT)\admin\wmi\winomi\base\$O\base.lib \
    $(ADMIN_LIB_PATH)\pal.lib \
    $(ADMIN_LIB_PATH)\nitsdll.lib \


UT_TARGET_DEST=WinOMI\tests
UNITTESTS_DEST = $(UT_TARGET_DEST)\codec\mof
UNITTESTS_SRC = $(PROJECT_ROOT)\wmi\$(UNITTESTS_DEST)\blue\mofs
PASS_INDEPENDENT_BINPLACE= \
    -:DEST $(UNITTESTS_DEST) $(UNITTESTS_SRC)\*.mof \

# Autogenerated. Sets file name for Device Guard whitelisting effort, used in RC.exe.
C_DEFINES=$(C_DEFINES) -D___TARGETNAME="""$(TARGETNAME).$(TARGETTYPE)"""
MUI_VERIFY_NO_LOC_RESOURCE=1
